{"ast":null,"code":"import hyphenate from \"./hyphenate-style-name\";\nimport { validateNoMixedHand } from \"./validate-no-mixed-hand\";\nimport { prefix } from \"inline-style-prefixer\";\nimport { MultiCache } from \"./cache\";\nexport default function injectStylePrefixed(styleCache, styles, media, pseudo) {\n  const cache = styleCache.getCache(media);\n  let classString = \"\";\n  for (const originalKey in styles) {\n    const originalVal = styles[originalKey];\n    if (originalVal === void 0 || originalVal === null) {\n      continue;\n    }\n    if (typeof originalVal !== \"object\") {\n      // Non-null and non-undefined primitive value\n      if (process.env.NODE_ENV !== \"production\") {\n        validateValueType(originalVal, originalKey);\n      }\n      const propValPair = `${hyphenate(originalKey)}:${originalVal}`;\n      const key = `${pseudo}${propValPair}`;\n      const cachedId = cache.cache[key];\n      if (cachedId !== void 0) {\n        // cache hit\n        classString += \" \" + cachedId;\n        continue;\n      } else {\n        // cache miss\n        let block = \"\";\n        const prefixed = prefix({\n          [originalKey]: originalVal\n        });\n        for (const prefixedKey in prefixed) {\n          const prefixedVal = prefixed[prefixedKey];\n          const prefixedValType = typeof prefixedVal;\n          if (prefixedValType === \"string\" || prefixedValType === \"number\") {\n            const prefixedPair = `${hyphenate(prefixedKey)}:${prefixedVal}`;\n            if (prefixedPair !== propValPair) {\n              block += `${prefixedPair};`;\n            }\n          } else if (Array.isArray(prefixedVal)) {\n            const hyphenated = hyphenate(prefixedKey);\n            for (let i = 0; i < prefixedVal.length; i++) {\n              const prefixedPair = `${hyphenated}:${prefixedVal[i]}`;\n              if (prefixedPair !== propValPair) {\n                block += `${prefixedPair};`;\n              }\n            }\n          }\n        }\n        block += propValPair; // ensure original prop/val is last (for hydration)\n\n        const id = cache.addValue(key, {\n          pseudo,\n          block\n        });\n        classString += \" \" + id;\n      }\n    } else {\n      // Non-null object value\n      if (originalKey[0] === \":\") {\n        classString += \" \" + injectStylePrefixed(styleCache, originalVal, media, pseudo + originalKey);\n      } else if (originalKey.substring(0, 6) === \"@media\") {\n        classString += \" \" + injectStylePrefixed(styleCache, originalVal, originalKey.substr(7), pseudo);\n      }\n    }\n  }\n  if (process.env.NODE_ENV !== \"production\") {\n    const conflicts = validateNoMixedHand(styles);\n    if (conflicts.length) {\n      conflicts.forEach(_ref => {\n        let {\n          shorthand,\n          longhand\n        } = _ref;\n        const short = JSON.stringify({\n          [shorthand.property]: shorthand.value\n        });\n        const long = JSON.stringify({\n          [longhand.property]: longhand.value\n        }); // eslint-disable-next-line no-console\n\n        console.warn(`Styles \\`${short}\\` and \\`${long}\\` in object yielding class \"${classString.slice(1)}\" may result in unexpected behavior. Mixing shorthand and longhand properties within the same style object is unsupported with atomic rendering.`);\n      });\n    }\n  } // remove leading space\n\n  return classString.slice(1);\n}\nfunction validateValueType(value, key) {\n  if (value === null || Array.isArray(value) || typeof value !== \"number\" && typeof value !== \"string\") {\n    throw new Error(`Unsupported style value: ${JSON.stringify(value)} used in property ${JSON.stringify(key)}`);\n  }\n}","map":{"version":3,"names":["hyphenate","validateNoMixedHand","prefix","MultiCache","injectStylePrefixed","styleCache","styles","media","pseudo","cache","getCache","classString","originalKey","originalVal","process","env","NODE_ENV","validateValueType","propValPair","key","cachedId","block","prefixed","prefixedKey","prefixedVal","prefixedValType","prefixedPair","Array","isArray","hyphenated","i","length","id","addValue","substring","substr","conflicts","forEach","_ref","shorthand","longhand","short","JSON","stringify","property","value","long","console","warn","slice","Error"],"sources":["src/inject-style-prefixed.ts"],"sourcesContent":["declare var __DEV__: boolean;\n\nimport hyphenate from \"./hyphenate-style-name\";\nimport {validateNoMixedHand} from \"./validate-no-mixed-hand\";\nimport {prefix} from \"inline-style-prefixer\";\n\nimport type {StyleObject} from \"styletron-standard\";\n\nimport {MultiCache} from \"./cache\";\n\nexport default function injectStylePrefixed(\n  styleCache: MultiCache<{\n    pseudo: string;\n    block: string;\n  }>,\n  styles: StyleObject,\n  media: string,\n  pseudo: string,\n) {\n  const cache = styleCache.getCache(media);\n  let classString = \"\";\n  for (const originalKey in styles) {\n    const originalVal = styles[originalKey];\n\n    if (originalVal === void 0 || originalVal === null) {\n      continue;\n    }\n    if (typeof originalVal !== \"object\") {\n      // Non-null and non-undefined primitive value\n      if (__DEV__) {\n        validateValueType(originalVal, originalKey);\n      }\n\n      const propValPair = `${hyphenate(originalKey)}:${\n        originalVal as any as string\n      }`;\n      const key = `${pseudo}${propValPair}`;\n      const cachedId = cache.cache[key];\n      if (cachedId !== void 0) {\n        // cache hit\n        classString += \" \" + cachedId;\n        continue;\n      } else {\n        // cache miss\n        let block = \"\";\n        const prefixed = prefix({[originalKey]: originalVal});\n        for (const prefixedKey in prefixed) {\n          const prefixedVal = prefixed[prefixedKey];\n          const prefixedValType = typeof prefixedVal;\n          if (prefixedValType === \"string\" || prefixedValType === \"number\") {\n            const prefixedPair = `${hyphenate(prefixedKey)}:${prefixedVal}`;\n            if (prefixedPair !== propValPair) {\n              block += `${prefixedPair};`;\n            }\n          } else if (Array.isArray(prefixedVal)) {\n            const hyphenated = hyphenate(prefixedKey);\n            for (let i = 0; i < prefixedVal.length; i++) {\n              const prefixedPair = `${hyphenated}:${prefixedVal[i]}`;\n              if (prefixedPair !== propValPair) {\n                block += `${prefixedPair};`;\n              }\n            }\n          }\n        }\n        block += propValPair; // ensure original prop/val is last (for hydration)\n        const id = cache.addValue(key, {pseudo, block});\n        classString += \" \" + id;\n      }\n    } else {\n      // Non-null object value\n      if (originalKey[0] === \":\") {\n        classString +=\n          \" \" +\n          injectStylePrefixed(\n            styleCache,\n            originalVal as StyleObject,\n            media,\n            pseudo + originalKey,\n          );\n      } else if (originalKey.substring(0, 6) === \"@media\") {\n        classString +=\n          \" \" +\n          injectStylePrefixed(\n            styleCache,\n            originalVal as StyleObject,\n            originalKey.substr(7),\n            pseudo,\n          );\n      }\n    }\n  }\n\n  if (__DEV__) {\n    const conflicts = validateNoMixedHand(styles);\n    if (conflicts.length) {\n      conflicts.forEach(({shorthand, longhand}) => {\n        const short = JSON.stringify({[shorthand.property]: shorthand.value});\n        const long = JSON.stringify({[longhand.property]: longhand.value});\n        // eslint-disable-next-line no-console\n        console.warn(\n          `Styles \\`${short}\\` and \\`${long}\\` in object yielding class \"${classString.slice(\n            1,\n          )}\" may result in unexpected behavior. Mixing shorthand and longhand properties within the same style object is unsupported with atomic rendering.`,\n        );\n      });\n    }\n  }\n\n  // remove leading space\n  return classString.slice(1);\n}\n\nfunction validateValueType(value, key) {\n  if (\n    value === null ||\n    Array.isArray(value) ||\n    (typeof value !== \"number\" && typeof value !== \"string\")\n  ) {\n    throw new Error(\n      `Unsupported style value: ${JSON.stringify(\n        value,\n      )} used in property ${JSON.stringify(key)}`,\n    );\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}
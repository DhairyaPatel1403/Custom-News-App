"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _sequentialIdGenerator = _interopRequireDefault(require("../sequential-id-generator"));

var _cache2 = require("../cache");

var _injectStylePrefixed = _interopRequireDefault(require("../inject-style-prefixed"));

var _css = require("../css");

var _devTool = require("../dev-tool");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/* eslint-env browser */
const STYLES_HYDRATOR = /\.([^{:]+)(:[^{]+)?{(?:[^}]*;)?([^}]*?)}/g;
const KEYFRAMES_HYRDATOR = /@keyframes ([^{]+){((?:(?:from|to|(?:\d+\.?\d*%))\{(?:[^}])*})*)}/g;
const FONT_FACE_HYDRATOR = /@font-face\{font-family:([^;]+);([^}]*)\}/g;

function hydrateStyles(cache, hydrator, css) {
  let match;

  while (match = hydrator.exec(css)) {
    const [, id, pseudo, key] = match;

    if (true && process.env.NODE_ENV !== "production" && window.__STYLETRON_DEVTOOLS__) {
      (0, _devTool.hydrateDevtoolsRule)(match[0]);
    }

    const fullKey = pseudo ? `${pseudo}${key}` : key;
    cache.cache[fullKey] = id; // set cache without triggering side effects

    cache.idGenerator.increment(); // increment id
  }
}

function hydrate(cache, hydrator, css) {
  let match;

  while (match = hydrator.exec(css)) {
    const [, id, key] = match;

    if (true && process.env.NODE_ENV !== "production" && window.__STYLETRON_DEVTOOLS__) {
      (0, _devTool.hydrateDevtoolsRule)(match[0]);
    }

    cache.cache[key] = id; // set cache without triggering side effects

    cache.idGenerator.increment(); // increment id
  }
}

class StyletronClient {
  constructor(opts = {}) {
    this.styleElements = {};
    const styleIdGenerator = new _sequentialIdGenerator.default(opts.prefix);

    const onNewStyle = (cache, id, value) => {
      const {
        pseudo,
        block
      } = value;
      const sheet = this.styleElements[cache.key].sheet;
      const selector = (0, _css.atomicSelector)(id, pseudo);
      const rule = (0, _css.styleBlockToRule)(selector, block);

      try {
        sheet.insertRule(rule, sheet.cssRules.length);

        if (true && process.env.NODE_ENV !== "production" && window.__STYLETRON_DEVTOOLS__) {
          (0, _devTool.insertRuleIntoDevtools)(selector, block);
        }
      } catch (e) {
        if (process.env.NODE_ENV !== "production") {
          // eslint-disable-next-line no-console
          console.warn(`Failed to inject CSS: "${rule}". Perhaps this has invalid or un-prefixed properties?`);
        }
      }
    }; // Setup style cache


    this.styleCache = new _cache2.MultiCache(styleIdGenerator, (media, _cache, insertBeforeMedia) => {
      const styleElement = document.createElement("style");
      styleElement.media = media;

      if (insertBeforeMedia === void 0) {
        this.container.appendChild(styleElement);
      } else {
        const insertBeforeIndex = findSheetIndexWithMedia(this.container.children, insertBeforeMedia);
        this.container.insertBefore(styleElement, this.container.children[insertBeforeIndex]);
      }

      this.styleElements[media] = styleElement;
    }, onNewStyle);
    this.keyframesCache = new _cache2.Cache(new _sequentialIdGenerator.default(opts.prefix), (cache, id, value) => {
      this.styleCache.getCache("");
      const sheet = this.styleElements[""].sheet;
      const rule = (0, _css.keyframesBlockToRule)(id, (0, _css.keyframesToBlock)(value));

      try {
        sheet.insertRule(rule, sheet.cssRules.length);
      } catch (e) {
        if (process.env.NODE_ENV !== "production") {
          // eslint-disable-next-line no-console
          console.warn(`Failed to inject CSS: "${rule}". Perhaps this has invalid or un-prefixed properties?`);
        }
      }
    });
    this.fontFaceCache = new _cache2.Cache(new _sequentialIdGenerator.default(opts.prefix), (cache, id, value) => {
      this.styleCache.getCache("");
      const sheet = this.styleElements[""].sheet;
      const rule = (0, _css.fontFaceBlockToRule)(id, (0, _css.declarationsToBlock)(value));

      try {
        sheet.insertRule(rule, sheet.cssRules.length);
      } catch (e) {
        if (process.env.NODE_ENV !== "production") {
          // eslint-disable-next-line no-console
          console.warn(`Failed to inject CSS: "${rule}". Perhaps this has invalid or un-prefixed properties?`);
        }
      }
    });

    if (opts.container) {
      this.container = opts.container;
    } // Hydrate


    if (opts.hydrate && opts.hydrate.length > 0) {
      // infer container from parent element
      if (!this.container) {
        const parentElement = opts.hydrate[0].parentElement;

        if (parentElement !== null && parentElement !== void 0) {
          this.container = parentElement;
        }
      }

      for (let i = 0; i < opts.hydrate.length; i++) {
        const element = opts.hydrate[i];
        const hydrateType = element.getAttribute("data-hydrate");

        if (hydrateType === "font-face") {
          hydrate(this.fontFaceCache, FONT_FACE_HYDRATOR, element.textContent);
          continue;
        }

        if (hydrateType === "keyframes") {
          hydrate(this.keyframesCache, KEYFRAMES_HYRDATOR, element.textContent);
          continue;
        }

        const key = element.media ? element.media : "";
        this.styleElements[key] = element;
        const cache = new _cache2.Cache(styleIdGenerator, onNewStyle);
        cache.key = key;
        hydrateStyles(cache, STYLES_HYDRATOR, element.textContent);
        this.styleCache.sortedCacheKeys.push(key);
        this.styleCache.caches[key] = cache;
      }
    }

    if (!this.container) {
      if (document.head === null) {
        throw new Error("No container provided and `document.head` was null");
      }

      this.container = document.head;
    }
  }

  renderStyle(style) {
    return (0, _injectStylePrefixed.default)(this.styleCache, style, "", "");
  }

  renderFontFace(fontFace) {
    const key = (0, _css.declarationsToBlock)(fontFace);
    return this.fontFaceCache.addValue(key, fontFace);
  }

  renderKeyframes(keyframes) {
    const key = (0, _css.keyframesToBlock)(keyframes);
    return this.keyframesCache.addValue(key, keyframes);
  }

}

var _default = StyletronClient;
exports.default = _default;

function findSheetIndexWithMedia(children, media) {
  let index = 0;

  for (; index < children.length; index++) {
    const child = children[index];

    if (child.tagName === "STYLE" && child.media === media) {
      return index;
    }
  }

  return -1;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTVFlMRVNfSFlEUkFUT1IiLCJLRVlGUkFNRVNfSFlSREFUT1IiLCJGT05UX0ZBQ0VfSFlEUkFUT1IiLCJoeWRyYXRlU3R5bGVzIiwiY2FjaGUiLCJoeWRyYXRvciIsImNzcyIsIm1hdGNoIiwiZXhlYyIsImlkIiwicHNldWRvIiwia2V5Iiwid2luZG93IiwiX19TVFlMRVRST05fREVWVE9PTFNfXyIsImh5ZHJhdGVEZXZ0b29sc1J1bGUiLCJmdWxsS2V5IiwiaWRHZW5lcmF0b3IiLCJpbmNyZW1lbnQiLCJoeWRyYXRlIiwiU3R5bGV0cm9uQ2xpZW50IiwiY29uc3RydWN0b3IiLCJvcHRzIiwic3R5bGVFbGVtZW50cyIsInN0eWxlSWRHZW5lcmF0b3IiLCJTZXF1ZW50aWFsSURHZW5lcmF0b3IiLCJwcmVmaXgiLCJvbk5ld1N0eWxlIiwidmFsdWUiLCJibG9jayIsInNoZWV0Iiwic2VsZWN0b3IiLCJhdG9taWNTZWxlY3RvciIsInJ1bGUiLCJzdHlsZUJsb2NrVG9SdWxlIiwiaW5zZXJ0UnVsZSIsImNzc1J1bGVzIiwibGVuZ3RoIiwiaW5zZXJ0UnVsZUludG9EZXZ0b29scyIsImUiLCJjb25zb2xlIiwid2FybiIsInN0eWxlQ2FjaGUiLCJNdWx0aUNhY2hlIiwibWVkaWEiLCJfY2FjaGUiLCJpbnNlcnRCZWZvcmVNZWRpYSIsInN0eWxlRWxlbWVudCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImNvbnRhaW5lciIsImFwcGVuZENoaWxkIiwiaW5zZXJ0QmVmb3JlSW5kZXgiLCJmaW5kU2hlZXRJbmRleFdpdGhNZWRpYSIsImNoaWxkcmVuIiwiaW5zZXJ0QmVmb3JlIiwia2V5ZnJhbWVzQ2FjaGUiLCJDYWNoZSIsImdldENhY2hlIiwia2V5ZnJhbWVzQmxvY2tUb1J1bGUiLCJrZXlmcmFtZXNUb0Jsb2NrIiwiZm9udEZhY2VDYWNoZSIsImZvbnRGYWNlQmxvY2tUb1J1bGUiLCJkZWNsYXJhdGlvbnNUb0Jsb2NrIiwicGFyZW50RWxlbWVudCIsImkiLCJlbGVtZW50IiwiaHlkcmF0ZVR5cGUiLCJnZXRBdHRyaWJ1dGUiLCJ0ZXh0Q29udGVudCIsInNvcnRlZENhY2hlS2V5cyIsInB1c2giLCJjYWNoZXMiLCJoZWFkIiwiRXJyb3IiLCJyZW5kZXJTdHlsZSIsInN0eWxlIiwiaW5qZWN0U3R5bGVQcmVmaXhlZCIsInJlbmRlckZvbnRGYWNlIiwiZm9udEZhY2UiLCJhZGRWYWx1ZSIsInJlbmRlcktleWZyYW1lcyIsImtleWZyYW1lcyIsImluZGV4IiwiY2hpbGQiLCJ0YWdOYW1lIl0sInNvdXJjZXMiOlsic3JjL2NsaWVudC9jbGllbnQudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWVudiBicm93c2VyICovXG5cbmRlY2xhcmUgdmFyIF9fREVWX186IGJvb2xlYW47XG5cbmRlY2xhcmUgdmFyIF9fQlJPV1NFUl9fOiBib29sZWFuO1xuXG5jb25zdCBTVFlMRVNfSFlEUkFUT1IgPSAvXFwuKFteezpdKykoOltee10rKT97KD86W159XSo7KT8oW159XSo/KX0vZztcbmNvbnN0IEtFWUZSQU1FU19IWVJEQVRPUiA9XG4gIC9Aa2V5ZnJhbWVzIChbXntdKyl7KCg/Oig/OmZyb218dG98KD86XFxkK1xcLj9cXGQqJSkpXFx7KD86W159XSkqfSkqKX0vZztcbmNvbnN0IEZPTlRfRkFDRV9IWURSQVRPUiA9IC9AZm9udC1mYWNlXFx7Zm9udC1mYW1pbHk6KFteO10rKTsoW159XSopXFx9L2c7XG5cbnR5cGUgaHlkcmF0b3JUID1cbiAgfCB0eXBlb2YgU1RZTEVTX0hZRFJBVE9SXG4gIHwgdHlwZW9mIEtFWUZSQU1FU19IWVJEQVRPUlxuICB8IHR5cGVvZiBGT05UX0ZBQ0VfSFlEUkFUT1I7XG5cbmZ1bmN0aW9uIGh5ZHJhdGVTdHlsZXM8VD4oY2FjaGU6IENhY2hlPFQ+LCBoeWRyYXRvcjogaHlkcmF0b3JULCBjc3M6IHN0cmluZykge1xuICBsZXQgbWF0Y2g7XG4gIHdoaWxlICgobWF0Y2ggPSBoeWRyYXRvci5leGVjKGNzcykpKSB7XG4gICAgY29uc3QgWywgaWQsIHBzZXVkbywga2V5XSA9IG1hdGNoO1xuICAgIGlmIChfX0JST1dTRVJfXyAmJiBfX0RFVl9fICYmIHdpbmRvdy5fX1NUWUxFVFJPTl9ERVZUT09MU19fKSB7XG4gICAgICBoeWRyYXRlRGV2dG9vbHNSdWxlKG1hdGNoWzBdKTtcbiAgICB9XG4gICAgY29uc3QgZnVsbEtleSA9IHBzZXVkbyA/IGAke3BzZXVkb30ke2tleX1gIDoga2V5O1xuICAgIGNhY2hlLmNhY2hlW2Z1bGxLZXldID0gaWQ7IC8vIHNldCBjYWNoZSB3aXRob3V0IHRyaWdnZXJpbmcgc2lkZSBlZmZlY3RzXG4gICAgY2FjaGUuaWRHZW5lcmF0b3IuaW5jcmVtZW50KCk7IC8vIGluY3JlbWVudCBpZFxuICB9XG59XG5cbmZ1bmN0aW9uIGh5ZHJhdGU8VD4oY2FjaGU6IENhY2hlPFQ+LCBoeWRyYXRvcjogaHlkcmF0b3JULCBjc3M6IHN0cmluZykge1xuICBsZXQgbWF0Y2g7XG4gIHdoaWxlICgobWF0Y2ggPSBoeWRyYXRvci5leGVjKGNzcykpKSB7XG4gICAgY29uc3QgWywgaWQsIGtleV0gPSBtYXRjaDtcbiAgICBpZiAoX19CUk9XU0VSX18gJiYgX19ERVZfXyAmJiB3aW5kb3cuX19TVFlMRVRST05fREVWVE9PTFNfXykge1xuICAgICAgaHlkcmF0ZURldnRvb2xzUnVsZShtYXRjaFswXSk7XG4gICAgfVxuICAgIGNhY2hlLmNhY2hlW2tleV0gPSBpZDsgLy8gc2V0IGNhY2hlIHdpdGhvdXQgdHJpZ2dlcmluZyBzaWRlIGVmZmVjdHNcbiAgICBjYWNoZS5pZEdlbmVyYXRvci5pbmNyZW1lbnQoKTsgLy8gaW5jcmVtZW50IGlkXG4gIH1cbn1cblxuaW1wb3J0IFNlcXVlbnRpYWxJREdlbmVyYXRvciBmcm9tIFwiLi4vc2VxdWVudGlhbC1pZC1nZW5lcmF0b3JcIjtcblxuaW1wb3J0IHR5cGUge1xuICBTdGFuZGFyZEVuZ2luZSxcbiAgS2V5ZnJhbWVzT2JqZWN0LFxuICBGb250RmFjZU9iamVjdCxcbiAgU3R5bGVPYmplY3QsXG59IGZyb20gXCJzdHlsZXRyb24tc3RhbmRhcmRcIjtcblxuaW1wb3J0IHtDYWNoZSwgTXVsdGlDYWNoZX0gZnJvbSBcIi4uL2NhY2hlXCI7XG5cbmltcG9ydCBpbmplY3RTdHlsZVByZWZpeGVkIGZyb20gXCIuLi9pbmplY3Qtc3R5bGUtcHJlZml4ZWRcIjtcblxuaW1wb3J0IHtcbiAgc3R5bGVCbG9ja1RvUnVsZSxcbiAgYXRvbWljU2VsZWN0b3IsXG4gIGtleWZyYW1lc0Jsb2NrVG9SdWxlLFxuICBkZWNsYXJhdGlvbnNUb0Jsb2NrLFxuICBrZXlmcmFtZXNUb0Jsb2NrLFxuICBmb250RmFjZUJsb2NrVG9SdWxlLFxufSBmcm9tIFwiLi4vY3NzXCI7XG5pbXBvcnQge2luc2VydFJ1bGVJbnRvRGV2dG9vbHMsIGh5ZHJhdGVEZXZ0b29sc1J1bGV9IGZyb20gXCIuLi9kZXYtdG9vbFwiO1xuXG50eXBlIGh5ZHJhdGVUID1cbiAgfCBIVE1MQ29sbGVjdGlvbk9mPEhUTUxTdHlsZUVsZW1lbnQ+XG4gIHwgQXJyYXk8SFRNTFN0eWxlRWxlbWVudD5cbiAgfCBOb2RlTGlzdE9mPEhUTUxTdHlsZUVsZW1lbnQ+O1xuXG50eXBlIG9wdGlvbnNUID0ge1xuICBoeWRyYXRlPzogaHlkcmF0ZVQ7XG4gIGNvbnRhaW5lcj86IEVsZW1lbnQ7XG4gIHByZWZpeD86IHN0cmluZztcbn07XG5cbmNsYXNzIFN0eWxldHJvbkNsaWVudCBpbXBsZW1lbnRzIFN0YW5kYXJkRW5naW5lIHtcbiAgY29udGFpbmVyOiBFbGVtZW50O1xuICBzdHlsZUVsZW1lbnRzOiB7XG4gICAgW3g6IHN0cmluZ106IEhUTUxTdHlsZUVsZW1lbnQ7XG4gIH07XG4gIGZvbnRGYWNlU2hlZXQ6IEhUTUxTdHlsZUVsZW1lbnQ7XG4gIGtleWZyYW1lc1NoZWV0OiBIVE1MU3R5bGVFbGVtZW50O1xuXG4gIHN0eWxlQ2FjaGU6IE11bHRpQ2FjaGU8e1xuICAgIHBzZXVkbzogc3RyaW5nO1xuICAgIGJsb2NrOiBzdHJpbmc7XG4gIH0+O1xuICBrZXlmcmFtZXNDYWNoZTogQ2FjaGU8S2V5ZnJhbWVzT2JqZWN0PjtcbiAgZm9udEZhY2VDYWNoZTogQ2FjaGU8Rm9udEZhY2VPYmplY3Q+O1xuXG4gIGNvbnN0cnVjdG9yKG9wdHM6IG9wdGlvbnNUID0ge30pIHtcbiAgICB0aGlzLnN0eWxlRWxlbWVudHMgPSB7fTtcblxuICAgIGNvbnN0IHN0eWxlSWRHZW5lcmF0b3IgPSBuZXcgU2VxdWVudGlhbElER2VuZXJhdG9yKG9wdHMucHJlZml4KTtcbiAgICBjb25zdCBvbk5ld1N0eWxlID0gKGNhY2hlLCBpZCwgdmFsdWUpID0+IHtcbiAgICAgIGNvbnN0IHtwc2V1ZG8sIGJsb2NrfSA9IHZhbHVlO1xuICAgICAgY29uc3Qgc2hlZXQ6IENTU1N0eWxlU2hlZXQgPSB0aGlzLnN0eWxlRWxlbWVudHNbY2FjaGUua2V5XS5zaGVldCBhcyBhbnk7XG4gICAgICBjb25zdCBzZWxlY3RvciA9IGF0b21pY1NlbGVjdG9yKGlkLCBwc2V1ZG8pO1xuICAgICAgY29uc3QgcnVsZSA9IHN0eWxlQmxvY2tUb1J1bGUoc2VsZWN0b3IsIGJsb2NrKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIHNoZWV0Lmluc2VydFJ1bGUocnVsZSwgc2hlZXQuY3NzUnVsZXMubGVuZ3RoKTtcbiAgICAgICAgaWYgKF9fQlJPV1NFUl9fICYmIF9fREVWX18gJiYgd2luZG93Ll9fU1RZTEVUUk9OX0RFVlRPT0xTX18pIHtcbiAgICAgICAgICBpbnNlcnRSdWxlSW50b0RldnRvb2xzKHNlbGVjdG9yLCBibG9jayk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgaWYgKF9fREVWX18pIHtcbiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgICAgIGBGYWlsZWQgdG8gaW5qZWN0IENTUzogXCIke3J1bGV9XCIuIFBlcmhhcHMgdGhpcyBoYXMgaW52YWxpZCBvciB1bi1wcmVmaXhlZCBwcm9wZXJ0aWVzP2AsXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBTZXR1cCBzdHlsZSBjYWNoZVxuICAgIHRoaXMuc3R5bGVDYWNoZSA9IG5ldyBNdWx0aUNhY2hlKFxuICAgICAgc3R5bGVJZEdlbmVyYXRvcixcbiAgICAgIChtZWRpYSwgX2NhY2hlLCBpbnNlcnRCZWZvcmVNZWRpYSkgPT4ge1xuICAgICAgICBjb25zdCBzdHlsZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XG4gICAgICAgIHN0eWxlRWxlbWVudC5tZWRpYSA9IG1lZGlhO1xuICAgICAgICBpZiAoaW5zZXJ0QmVmb3JlTWVkaWEgPT09IHZvaWQgMCkge1xuICAgICAgICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZENoaWxkKHN0eWxlRWxlbWVudCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc3QgaW5zZXJ0QmVmb3JlSW5kZXggPSBmaW5kU2hlZXRJbmRleFdpdGhNZWRpYShcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLmNoaWxkcmVuLFxuICAgICAgICAgICAgaW5zZXJ0QmVmb3JlTWVkaWEsXG4gICAgICAgICAgKTtcbiAgICAgICAgICB0aGlzLmNvbnRhaW5lci5pbnNlcnRCZWZvcmUoXG4gICAgICAgICAgICBzdHlsZUVsZW1lbnQsXG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5jaGlsZHJlbltpbnNlcnRCZWZvcmVJbmRleF0sXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc3R5bGVFbGVtZW50c1ttZWRpYV0gPSBzdHlsZUVsZW1lbnQ7XG4gICAgICB9LFxuICAgICAgb25OZXdTdHlsZSxcbiAgICApO1xuXG4gICAgdGhpcy5rZXlmcmFtZXNDYWNoZSA9IG5ldyBDYWNoZShcbiAgICAgIG5ldyBTZXF1ZW50aWFsSURHZW5lcmF0b3Iob3B0cy5wcmVmaXgpLFxuICAgICAgKGNhY2hlLCBpZCwgdmFsdWUpID0+IHtcbiAgICAgICAgdGhpcy5zdHlsZUNhY2hlLmdldENhY2hlKFwiXCIpO1xuICAgICAgICBjb25zdCBzaGVldDogQ1NTU3R5bGVTaGVldCA9IHRoaXMuc3R5bGVFbGVtZW50c1tcIlwiXS5zaGVldCBhcyBhbnk7XG4gICAgICAgIGNvbnN0IHJ1bGUgPSBrZXlmcmFtZXNCbG9ja1RvUnVsZShpZCwga2V5ZnJhbWVzVG9CbG9jayh2YWx1ZSkpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHNoZWV0Lmluc2VydFJ1bGUocnVsZSwgc2hlZXQuY3NzUnVsZXMubGVuZ3RoKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIGlmIChfX0RFVl9fKSB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgICAgICBgRmFpbGVkIHRvIGluamVjdCBDU1M6IFwiJHtydWxlfVwiLiBQZXJoYXBzIHRoaXMgaGFzIGludmFsaWQgb3IgdW4tcHJlZml4ZWQgcHJvcGVydGllcz9gLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgKTtcblxuICAgIHRoaXMuZm9udEZhY2VDYWNoZSA9IG5ldyBDYWNoZShcbiAgICAgIG5ldyBTZXF1ZW50aWFsSURHZW5lcmF0b3Iob3B0cy5wcmVmaXgpLFxuICAgICAgKGNhY2hlLCBpZCwgdmFsdWUpID0+IHtcbiAgICAgICAgdGhpcy5zdHlsZUNhY2hlLmdldENhY2hlKFwiXCIpO1xuICAgICAgICBjb25zdCBzaGVldDogQ1NTU3R5bGVTaGVldCA9IHRoaXMuc3R5bGVFbGVtZW50c1tcIlwiXS5zaGVldCBhcyBhbnk7XG4gICAgICAgIGNvbnN0IHJ1bGUgPSBmb250RmFjZUJsb2NrVG9SdWxlKGlkLCBkZWNsYXJhdGlvbnNUb0Jsb2NrKHZhbHVlKSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgc2hlZXQuaW5zZXJ0UnVsZShydWxlLCBzaGVldC5jc3NSdWxlcy5sZW5ndGgpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgaWYgKF9fREVWX18pIHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgICAgIGBGYWlsZWQgdG8gaW5qZWN0IENTUzogXCIke3J1bGV9XCIuIFBlcmhhcHMgdGhpcyBoYXMgaW52YWxpZCBvciB1bi1wcmVmaXhlZCBwcm9wZXJ0aWVzP2AsXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICApO1xuXG4gICAgaWYgKG9wdHMuY29udGFpbmVyKSB7XG4gICAgICB0aGlzLmNvbnRhaW5lciA9IG9wdHMuY29udGFpbmVyO1xuICAgIH1cblxuICAgIC8vIEh5ZHJhdGVcbiAgICBpZiAob3B0cy5oeWRyYXRlICYmIG9wdHMuaHlkcmF0ZS5sZW5ndGggPiAwKSB7XG4gICAgICAvLyBpbmZlciBjb250YWluZXIgZnJvbSBwYXJlbnQgZWxlbWVudFxuICAgICAgaWYgKCF0aGlzLmNvbnRhaW5lcikge1xuICAgICAgICBjb25zdCBwYXJlbnRFbGVtZW50ID0gb3B0cy5oeWRyYXRlWzBdLnBhcmVudEVsZW1lbnQ7XG4gICAgICAgIGlmIChwYXJlbnRFbGVtZW50ICE9PSBudWxsICYmIHBhcmVudEVsZW1lbnQgIT09IHZvaWQgMCkge1xuICAgICAgICAgIHRoaXMuY29udGFpbmVyID0gcGFyZW50RWxlbWVudDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9wdHMuaHlkcmF0ZS5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBlbGVtZW50ID0gb3B0cy5oeWRyYXRlW2ldO1xuICAgICAgICBjb25zdCBoeWRyYXRlVHlwZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1oeWRyYXRlXCIpO1xuICAgICAgICBpZiAoaHlkcmF0ZVR5cGUgPT09IFwiZm9udC1mYWNlXCIpIHtcbiAgICAgICAgICBoeWRyYXRlKHRoaXMuZm9udEZhY2VDYWNoZSwgRk9OVF9GQUNFX0hZRFJBVE9SLCBlbGVtZW50LnRleHRDb250ZW50KTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaHlkcmF0ZVR5cGUgPT09IFwia2V5ZnJhbWVzXCIpIHtcbiAgICAgICAgICBoeWRyYXRlKHRoaXMua2V5ZnJhbWVzQ2FjaGUsIEtFWUZSQU1FU19IWVJEQVRPUiwgZWxlbWVudC50ZXh0Q29udGVudCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qga2V5ID0gZWxlbWVudC5tZWRpYSA/IGVsZW1lbnQubWVkaWEgOiBcIlwiO1xuICAgICAgICB0aGlzLnN0eWxlRWxlbWVudHNba2V5XSA9IGVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IGNhY2hlID0gbmV3IENhY2hlKHN0eWxlSWRHZW5lcmF0b3IsIG9uTmV3U3R5bGUpO1xuICAgICAgICBjYWNoZS5rZXkgPSBrZXk7XG4gICAgICAgIGh5ZHJhdGVTdHlsZXMoY2FjaGUsIFNUWUxFU19IWURSQVRPUiwgZWxlbWVudC50ZXh0Q29udGVudCk7XG4gICAgICAgIHRoaXMuc3R5bGVDYWNoZS5zb3J0ZWRDYWNoZUtleXMucHVzaChrZXkpO1xuICAgICAgICB0aGlzLnN0eWxlQ2FjaGUuY2FjaGVzW2tleV0gPSBjYWNoZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuY29udGFpbmVyKSB7XG4gICAgICBpZiAoZG9jdW1lbnQuaGVhZCA9PT0gbnVsbCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBjb250YWluZXIgcHJvdmlkZWQgYW5kIGBkb2N1bWVudC5oZWFkYCB3YXMgbnVsbFwiKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuY29udGFpbmVyID0gZG9jdW1lbnQuaGVhZDtcbiAgICB9XG4gIH1cblxuICByZW5kZXJTdHlsZShzdHlsZTogU3R5bGVPYmplY3QpOiBzdHJpbmcge1xuICAgIHJldHVybiBpbmplY3RTdHlsZVByZWZpeGVkKHRoaXMuc3R5bGVDYWNoZSwgc3R5bGUsIFwiXCIsIFwiXCIpO1xuICB9XG5cbiAgcmVuZGVyRm9udEZhY2UoZm9udEZhY2U6IEZvbnRGYWNlT2JqZWN0KTogc3RyaW5nIHtcbiAgICBjb25zdCBrZXkgPSBkZWNsYXJhdGlvbnNUb0Jsb2NrKGZvbnRGYWNlKTtcbiAgICByZXR1cm4gdGhpcy5mb250RmFjZUNhY2hlLmFkZFZhbHVlKGtleSwgZm9udEZhY2UpO1xuICB9XG5cbiAgcmVuZGVyS2V5ZnJhbWVzKGtleWZyYW1lczogS2V5ZnJhbWVzT2JqZWN0KTogc3RyaW5nIHtcbiAgICBjb25zdCBrZXkgPSBrZXlmcmFtZXNUb0Jsb2NrKGtleWZyYW1lcyk7XG4gICAgcmV0dXJuIHRoaXMua2V5ZnJhbWVzQ2FjaGUuYWRkVmFsdWUoa2V5LCBrZXlmcmFtZXMpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFN0eWxldHJvbkNsaWVudDtcblxuZnVuY3Rpb24gZmluZFNoZWV0SW5kZXhXaXRoTWVkaWEoY2hpbGRyZW4sIG1lZGlhKSB7XG4gIGxldCBpbmRleCA9IDA7XG4gIGZvciAoOyBpbmRleCA8IGNoaWxkcmVuLmxlbmd0aDsgaW5kZXgrKykge1xuICAgIGNvbnN0IGNoaWxkID0gY2hpbGRyZW5baW5kZXhdO1xuICAgIGlmIChcbiAgICAgIGNoaWxkLnRhZ05hbWUgPT09IFwiU1RZTEVcIiAmJlxuICAgICAgKGNoaWxkIGFzIGFueSBhcyBIVE1MU3R5bGVFbGVtZW50KS5tZWRpYSA9PT0gbWVkaWFcbiAgICApIHtcbiAgICAgIHJldHVybiBpbmRleDtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gLTE7XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUF5Q0E7O0FBU0E7O0FBRUE7O0FB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
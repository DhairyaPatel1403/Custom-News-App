import SequentialIDGenerator from "../sequential-id-generator";
import { Cache, MultiCache } from "../cache";
import injectStylePrefixed from "../inject-style-prefixed";
import { styleBlockToRule, atomicSelector, keyframesBlockToRule, declarationsToBlock, keyframesToBlock, fontFaceBlockToRule } from "../css";

class StyletronServer {
  constructor(opts = {}) {
    this.styleRules = {
      "": ""
    };
    this.styleCache = new MultiCache(new SequentialIDGenerator(opts.prefix), media => {
      this.styleRules[media] = "";
    }, (cache, id, value) => {
      const {
        pseudo,
        block
      } = value;
      this.styleRules[cache.key] += styleBlockToRule(atomicSelector(id, pseudo), block);
    });
    this.fontFaceRules = "";
    this.fontFaceCache = new Cache(new SequentialIDGenerator(opts.prefix), (cache, id, value) => {
      this.fontFaceRules += fontFaceBlockToRule(id, declarationsToBlock(value));
    });
    this.keyframesRules = "";
    this.keyframesCache = new Cache(new SequentialIDGenerator(opts.prefix), (cache, id, value) => {
      this.keyframesRules += keyframesBlockToRule(id, keyframesToBlock(value));
    });
  }

  renderStyle(style) {
    return injectStylePrefixed(this.styleCache, style, "", "");
  }

  renderFontFace(fontFace) {
    const key = JSON.stringify(fontFace);
    return this.fontFaceCache.addValue(key, fontFace);
  }

  renderKeyframes(keyframes) {
    const key = JSON.stringify(keyframes);
    return this.keyframesCache.addValue(key, keyframes);
  }

  getStylesheets() {
    return [...(this.keyframesRules.length ? [{
      css: this.keyframesRules,
      attrs: {
        "data-hydrate": "keyframes"
      }
    }] : []), ...(this.fontFaceRules.length ? [{
      css: this.fontFaceRules,
      attrs: {
        "data-hydrate": "font-face"
      }
    }] : []), ...sheetify(this.styleRules, this.styleCache.getSortedCacheKeys())];
  }

  getStylesheetsHtml(className = "_styletron_hydrate_") {
    return generateHtmlString(this.getStylesheets(), className);
  }

  getCss() {
    return this.keyframesRules + this.fontFaceRules + stringify(this.styleRules, this.styleCache.getSortedCacheKeys());
  }

}

export function generateHtmlString(sheets, className) {
  let html = "";

  for (let i = 0; i < sheets.length; i++) {
    const sheet = sheets[i];
    const {
      class: originalClassName,
      ...rest
    } = sheet.attrs;
    const attrs = {
      class: originalClassName ? `${className} ${originalClassName}` : className,
      ...rest
    };
    html += `<style${attrsToString(attrs)}>${sheet.css}</style>`;
  }

  return html;
}

function attrsToString(attrs) {
  let result = "";

  for (const attr in attrs) {
    const value = attrs[attr];

    if (value === true) {
      result += " " + attr;
    } else if (value !== false) {
      result += ` ${attr}="${value}"`;
    }
  }

  return result;
}

function stringify(styleRules, sortedCacheKeys) {
  let result = "";
  sortedCacheKeys.forEach(cacheKey => {
    const rules = styleRules[cacheKey];

    if (cacheKey !== "") {
      result += `@media ${cacheKey}{${rules}}`;
    } else {
      result += rules;
    }
  });
  return result;
}

function sheetify(styleRules, sortedCacheKeys) {
  if (sortedCacheKeys.length === 0) {
    return [{
      css: "",
      attrs: {}
    }];
  }

  const sheets = [];
  sortedCacheKeys.forEach(cacheKey => {
    // omit media (cacheKey) attribute if empty
    const attrs = cacheKey === "" ? {} : {
      media: cacheKey
    };
    sheets.push({
      css: styleRules[cacheKey],
      attrs
    });
  });
  return sheets;
}

export default StyletronServer;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTZXF1ZW50aWFsSURHZW5lcmF0b3IiLCJDYWNoZSIsIk11bHRpQ2FjaGUiLCJpbmplY3RTdHlsZVByZWZpeGVkIiwic3R5bGVCbG9ja1RvUnVsZSIsImF0b21pY1NlbGVjdG9yIiwia2V5ZnJhbWVzQmxvY2tUb1J1bGUiLCJkZWNsYXJhdGlvbnNUb0Jsb2NrIiwia2V5ZnJhbWVzVG9CbG9jayIsImZvbnRGYWNlQmxvY2tUb1J1bGUiLCJTdHlsZXRyb25TZXJ2ZXIiLCJjb25zdHJ1Y3RvciIsIm9wdHMiLCJzdHlsZVJ1bGVzIiwic3R5bGVDYWNoZSIsInByZWZpeCIsIm1lZGlhIiwiY2FjaGUiLCJpZCIsInZhbHVlIiwicHNldWRvIiwiYmxvY2siLCJrZXkiLCJmb250RmFjZVJ1bGVzIiwiZm9udEZhY2VDYWNoZSIsImtleWZyYW1lc1J1bGVzIiwia2V5ZnJhbWVzQ2FjaGUiLCJyZW5kZXJTdHlsZSIsInN0eWxlIiwicmVuZGVyRm9udEZhY2UiLCJmb250RmFjZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhZGRWYWx1ZSIsInJlbmRlcktleWZyYW1lcyIsImtleWZyYW1lcyIsImdldFN0eWxlc2hlZXRzIiwibGVuZ3RoIiwiY3NzIiwiYXR0cnMiLCJzaGVldGlmeSIsImdldFNvcnRlZENhY2hlS2V5cyIsImdldFN0eWxlc2hlZXRzSHRtbCIsImNsYXNzTmFtZSIsImdlbmVyYXRlSHRtbFN0cmluZyIsImdldENzcyIsInNoZWV0cyIsImh0bWwiLCJpIiwic2hlZXQiLCJjbGFzcyIsIm9yaWdpbmFsQ2xhc3NOYW1lIiwicmVzdCIsImF0dHJzVG9TdHJpbmciLCJyZXN1bHQiLCJhdHRyIiwic29ydGVkQ2FjaGVLZXlzIiwiZm9yRWFjaCIsImNhY2hlS2V5IiwicnVsZXMiLCJwdXNoIl0sInNvdXJjZXMiOlsic3JjL3NlcnZlci9zZXJ2ZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFNlcXVlbnRpYWxJREdlbmVyYXRvciBmcm9tIFwiLi4vc2VxdWVudGlhbC1pZC1nZW5lcmF0b3JcIjtcblxuaW1wb3J0IHR5cGUge1N0YW5kYXJkRW5naW5lfSBmcm9tIFwic3R5bGV0cm9uLXN0YW5kYXJkXCI7XG5cbmltcG9ydCB7Q2FjaGUsIE11bHRpQ2FjaGV9IGZyb20gXCIuLi9jYWNoZVwiO1xuXG5pbXBvcnQgaW5qZWN0U3R5bGVQcmVmaXhlZCBmcm9tIFwiLi4vaW5qZWN0LXN0eWxlLXByZWZpeGVkXCI7XG5cbmltcG9ydCB0eXBlIHtcbiAgU3R5bGVPYmplY3QsXG4gIEZvbnRGYWNlT2JqZWN0LFxuICBLZXlmcmFtZXNPYmplY3QsXG59IGZyb20gXCJzdHlsZXRyb24tc3RhbmRhcmRcIjtcblxuaW1wb3J0IHtcbiAgc3R5bGVCbG9ja1RvUnVsZSxcbiAgYXRvbWljU2VsZWN0b3IsXG4gIGtleWZyYW1lc0Jsb2NrVG9SdWxlLFxuICBkZWNsYXJhdGlvbnNUb0Jsb2NrLFxuICBrZXlmcmFtZXNUb0Jsb2NrLFxuICBmb250RmFjZUJsb2NrVG9SdWxlLFxufSBmcm9tIFwiLi4vY3NzXCI7XG5cbmV4cG9ydCB0eXBlIGF0dHJzVCA9IHtcbiAgXCJkYXRhLWh5ZHJhdGVcIj86IFwia2V5ZnJhbWVzXCIgfCBcImZvbnQtZmFjZVwiO1xuICBtZWRpYT86IHN0cmluZztcbiAgY2xhc3M/OiBzdHJpbmc7XG59O1xuXG5leHBvcnQgdHlwZSBzaGVldFQgPSB7XG4gIGNzczogc3RyaW5nO1xuICBhdHRyczogYXR0cnNUO1xufTtcblxudHlwZSBvcHRpb25zVCA9IHtcbiAgcHJlZml4Pzogc3RyaW5nO1xufTtcblxuY2xhc3MgU3R5bGV0cm9uU2VydmVyIGltcGxlbWVudHMgU3RhbmRhcmRFbmdpbmUge1xuICBzdHlsZUNhY2hlOiBNdWx0aUNhY2hlPHtcbiAgICBwc2V1ZG86IHN0cmluZztcbiAgICBibG9jazogc3RyaW5nO1xuICB9PjtcbiAga2V5ZnJhbWVzQ2FjaGU6IENhY2hlPEtleWZyYW1lc09iamVjdD47XG4gIGZvbnRGYWNlQ2FjaGU6IENhY2hlPEZvbnRGYWNlT2JqZWN0PjtcbiAgc3R5bGVSdWxlczoge1xuICAgIFt4OiBzdHJpbmddOiBzdHJpbmc7XG4gIH07XG4gIGtleWZyYW1lc1J1bGVzOiBzdHJpbmc7XG4gIGZvbnRGYWNlUnVsZXM6IHN0cmluZztcblxuICBjb25zdHJ1Y3RvcihvcHRzOiBvcHRpb25zVCA9IHt9KSB7XG4gICAgdGhpcy5zdHlsZVJ1bGVzID0ge1wiXCI6IFwiXCJ9O1xuICAgIHRoaXMuc3R5bGVDYWNoZSA9IG5ldyBNdWx0aUNhY2hlKFxuICAgICAgbmV3IFNlcXVlbnRpYWxJREdlbmVyYXRvcihvcHRzLnByZWZpeCksXG4gICAgICBtZWRpYSA9PiB7XG4gICAgICAgIHRoaXMuc3R5bGVSdWxlc1ttZWRpYV0gPSBcIlwiO1xuICAgICAgfSxcbiAgICAgIChjYWNoZSwgaWQsIHZhbHVlKSA9PiB7XG4gICAgICAgIGNvbnN0IHtwc2V1ZG8sIGJsb2NrfSA9IHZhbHVlO1xuICAgICAgICB0aGlzLnN0eWxlUnVsZXNbY2FjaGUua2V5XSArPSBzdHlsZUJsb2NrVG9SdWxlKFxuICAgICAgICAgIGF0b21pY1NlbGVjdG9yKGlkLCBwc2V1ZG8pLFxuICAgICAgICAgIGJsb2NrLFxuICAgICAgICApO1xuICAgICAgfSxcbiAgICApO1xuXG4gICAgdGhpcy5mb250RmFjZVJ1bGVzID0gXCJcIjtcbiAgICB0aGlzLmZvbnRGYWNlQ2FjaGUgPSBuZXcgQ2FjaGUoXG4gICAgICBuZXcgU2VxdWVudGlhbElER2VuZXJhdG9yKG9wdHMucHJlZml4KSxcbiAgICAgIChjYWNoZSwgaWQsIHZhbHVlKSA9PiB7XG4gICAgICAgIHRoaXMuZm9udEZhY2VSdWxlcyArPSBmb250RmFjZUJsb2NrVG9SdWxlKFxuICAgICAgICAgIGlkLFxuICAgICAgICAgIGRlY2xhcmF0aW9uc1RvQmxvY2sodmFsdWUpLFxuICAgICAgICApO1xuICAgICAgfSxcbiAgICApO1xuXG4gICAgdGhpcy5rZXlmcmFtZXNSdWxlcyA9IFwiXCI7XG4gICAgdGhpcy5rZXlmcmFtZXNDYWNoZSA9IG5ldyBDYWNoZShcbiAgICAgIG5ldyBTZXF1ZW50aWFsSURHZW5lcmF0b3Iob3B0cy5wcmVmaXgpLFxuICAgICAgKGNhY2hlLCBpZCwgdmFsdWUpID0+IHtcbiAgICAgICAgdGhpcy5rZXlmcmFtZXNSdWxlcyArPSBrZXlmcmFtZXNCbG9ja1RvUnVsZShcbiAgICAgICAgICBpZCxcbiAgICAgICAgICBrZXlmcmFtZXNUb0Jsb2NrKHZhbHVlKSxcbiAgICAgICAgKTtcbiAgICAgIH0sXG4gICAgKTtcbiAgfVxuXG4gIHJlbmRlclN0eWxlKHN0eWxlOiBTdHlsZU9iamVjdCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGluamVjdFN0eWxlUHJlZml4ZWQodGhpcy5zdHlsZUNhY2hlLCBzdHlsZSwgXCJcIiwgXCJcIik7XG4gIH1cblxuICByZW5kZXJGb250RmFjZShmb250RmFjZTogRm9udEZhY2VPYmplY3QpOiBzdHJpbmcge1xuICAgIGNvbnN0IGtleSA9IEpTT04uc3RyaW5naWZ5KGZvbnRGYWNlKTtcbiAgICByZXR1cm4gdGhpcy5mb250RmFjZUNhY2hlLmFkZFZhbHVlKGtleSwgZm9udEZhY2UpO1xuICB9XG5cbiAgcmVuZGVyS2V5ZnJhbWVzKGtleWZyYW1lczogS2V5ZnJhbWVzT2JqZWN0KTogc3RyaW5nIHtcbiAgICBjb25zdCBrZXkgPSBKU09OLnN0cmluZ2lmeShrZXlmcmFtZXMpO1xuICAgIHJldHVybiB0aGlzLmtleWZyYW1lc0NhY2hlLmFkZFZhbHVlKGtleSwga2V5ZnJhbWVzKTtcbiAgfVxuXG4gIGdldFN0eWxlc2hlZXRzKCk6IEFycmF5PHNoZWV0VD4ge1xuICAgIHJldHVybiBbXG4gICAgICAuLi4odGhpcy5rZXlmcmFtZXNSdWxlcy5sZW5ndGhcbiAgICAgICAgPyBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGNzczogdGhpcy5rZXlmcmFtZXNSdWxlcyxcbiAgICAgICAgICAgICAgYXR0cnM6IHtcImRhdGEtaHlkcmF0ZVwiOiBcImtleWZyYW1lc1wifSxcbiAgICAgICAgICAgIH0gYXMgc2hlZXRULFxuICAgICAgICAgIF1cbiAgICAgICAgOiBbXSksXG4gICAgICAuLi4odGhpcy5mb250RmFjZVJ1bGVzLmxlbmd0aFxuICAgICAgICA/IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgY3NzOiB0aGlzLmZvbnRGYWNlUnVsZXMsXG4gICAgICAgICAgICAgIGF0dHJzOiB7XCJkYXRhLWh5ZHJhdGVcIjogXCJmb250LWZhY2VcIn0sXG4gICAgICAgICAgICB9IGFzIHNoZWV0VCxcbiAgICAgICAgICBdXG4gICAgICAgIDogW10pLFxuICAgICAgLi4uc2hlZXRpZnkodGhpcy5zdHlsZVJ1bGVzLCB0aGlzLnN0eWxlQ2FjaGUuZ2V0U29ydGVkQ2FjaGVLZXlzKCkpLFxuICAgIF07XG4gIH1cblxuICBnZXRTdHlsZXNoZWV0c0h0bWwoY2xhc3NOYW1lOiBzdHJpbmcgPSBcIl9zdHlsZXRyb25faHlkcmF0ZV9cIikge1xuICAgIHJldHVybiBnZW5lcmF0ZUh0bWxTdHJpbmcodGhpcy5nZXRTdHlsZXNoZWV0cygpLCBjbGFzc05hbWUpO1xuICB9XG5cbiAgZ2V0Q3NzKCkge1xuICAgIHJldHVybiAoXG4gICAgICB0aGlzLmtleWZyYW1lc1J1bGVzICtcbiAgICAgIHRoaXMuZm9udEZhY2VSdWxlcyArXG4gICAgICBzdHJpbmdpZnkodGhpcy5zdHlsZVJ1bGVzLCB0aGlzLnN0eWxlQ2FjaGUuZ2V0U29ydGVkQ2FjaGVLZXlzKCkpXG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVIdG1sU3RyaW5nKHNoZWV0czogQXJyYXk8c2hlZXRUPiwgY2xhc3NOYW1lOiBzdHJpbmcpIHtcbiAgbGV0IGh0bWwgPSBcIlwiO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHNoZWV0cy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IHNoZWV0ID0gc2hlZXRzW2ldO1xuICAgIGNvbnN0IHtjbGFzczogb3JpZ2luYWxDbGFzc05hbWUsIC4uLnJlc3R9ID0gc2hlZXQuYXR0cnM7XG4gICAgY29uc3QgYXR0cnMgPSB7XG4gICAgICBjbGFzczogb3JpZ2luYWxDbGFzc05hbWVcbiAgICAgICAgPyBgJHtjbGFzc05hbWV9ICR7b3JpZ2luYWxDbGFzc05hbWV9YFxuICAgICAgICA6IGNsYXNzTmFtZSxcbiAgICAgIC4uLihyZXN0IGFzIGF0dHJzVCksXG4gICAgfTtcbiAgICBodG1sICs9IGA8c3R5bGUke2F0dHJzVG9TdHJpbmcoYXR0cnMpfT4ke3NoZWV0LmNzc308L3N0eWxlPmA7XG4gIH1cbiAgcmV0dXJuIGh0bWw7XG59XG5cbmZ1bmN0aW9uIGF0dHJzVG9TdHJpbmcoYXR0cnM6IGF0dHJzVCkge1xuICBsZXQgcmVzdWx0ID0gXCJcIjtcbiAgZm9yIChjb25zdCBhdHRyIGluIGF0dHJzKSB7XG4gICAgY29uc3QgdmFsdWUgPSBhdHRyc1thdHRyXTtcbiAgICBpZiAodmFsdWUgPT09IHRydWUpIHtcbiAgICAgIHJlc3VsdCArPSBcIiBcIiArIGF0dHI7XG4gICAgfSBlbHNlIGlmICh2YWx1ZSAhPT0gZmFsc2UpIHtcbiAgICAgIHJlc3VsdCArPSBgICR7YXR0cn09XCIke3ZhbHVlfVwiYDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZnVuY3Rpb24gc3RyaW5naWZ5KHN0eWxlUnVsZXMsIHNvcnRlZENhY2hlS2V5cykge1xuICBsZXQgcmVzdWx0ID0gXCJcIjtcbiAgc29ydGVkQ2FjaGVLZXlzLmZvckVhY2goY2FjaGVLZXkgPT4ge1xuICAgIGNvbnN0IHJ1bGVzID0gc3R5bGVSdWxlc1tjYWNoZUtleV07XG4gICAgaWYgKGNhY2hlS2V5ICE9PSBcIlwiKSB7XG4gICAgICByZXN1bHQgKz0gYEBtZWRpYSAke2NhY2hlS2V5fXske3J1bGVzfX1gO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXN1bHQgKz0gcnVsZXM7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZnVuY3Rpb24gc2hlZXRpZnkoc3R5bGVSdWxlcywgc29ydGVkQ2FjaGVLZXlzKTogQXJyYXk8c2hlZXRUPiB7XG4gIGlmIChzb3J0ZWRDYWNoZUtleXMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIFt7Y3NzOiBcIlwiLCBhdHRyczoge319XTtcbiAgfVxuICBjb25zdCBzaGVldHMgPSBbXTtcbiAgc29ydGVkQ2FjaGVLZXlzLmZvckVhY2goY2FjaGVLZXkgPT4ge1xuICAgIC8vIG9taXQgbWVkaWEgKGNhY2hlS2V5KSBhdHRyaWJ1dGUgaWYgZW1wdHlcbiAgICBjb25zdCBhdHRycyA9IGNhY2hlS2V5ID09PSBcIlwiID8ge30gOiB7bWVkaWE6IGNhY2hlS2V5fTtcbiAgICBzaGVldHMucHVzaCh7Y3NzOiBzdHlsZVJ1bGVzW2NhY2hlS2V5XSwgYXR0cnN9KTtcbiAgfSk7XG4gIHJldHVybiBzaGVldHM7XG59XG5cbmV4cG9ydCBkZWZhdWx0IFN0eWxldHJvblNlcnZlcjtcbiJdLCJtYXBwaW5ncyI6IkFBQUEsT0FBT0EscUJBQVAsTUFBa0MsNEJBQWxDO0FBSUEsU0FBUUMsS0FBUixFQUFlQyxVQUFmLFFBQWdDLFVBQWhDO0FBRUEsT0FBT0MsbUJBQVAsTUFBZ0MsMEJBQWhDO0FBUUEsU0FDRUMsZ0JBREYsRUFFRUMsY0FGRixFQUdFQyxvQkFIRixFQUlFQyxtQkFKRixFQUtFQyxnQkFMRixFQU1FQyxtQkFORixRQU9PLFFBUFA7O0FBd0JBLE1BQU1DLGVBQU4sQ0FBZ0Q7RUFhOUNDLFdBQVcsQ0FBQ0MsSUFBYyxHQUFHLEVBQWxCLEVBQXNCO0lBQy9CLEtBQUtDLFVBQUwsR0FBa0I7TUFBQyxJQUFJO0lBQUwsQ0FBbEI7SUFDQSxLQUFLQyxVQUFMLEdBQWtCLElBQUlaLFVBQUosQ0FDaEIsSUFBSUYscUJBQUosQ0FBMEJZLElBQUksQ0FBQ0csTUFBL0IsQ0FEZ0IsRUFFaEJDLEtBQUssSUFBSTtNQUNQLEtBQUtILFVBQUwsQ0FBZ0JHLEtBQWhCLElBQXlCLEVBQXpCO0lBQ0QsQ0FKZSxFQUtoQixDQUFDQyxLQUFELEVBQVFDLEVBQVIsRUFBWUMsS0FB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